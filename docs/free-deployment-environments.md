# 無料でデプロイできる環境の調査結果

## 概要

SplitMateプロジェクトに適した無料デプロイ環境の調査結果をまとめました。現在のプロジェクト構成（React + Node.js + MySQL）に最適な選択肢を評価し、推奨案を提示します。

## プロジェクト構成

- **フロントエンド**: React + TypeScript (Vite)
- **バックエンド**: Node.js + TypeScript (Express)
- **データベース**: MySQL
- **コンテナ化**: Docker Compose

## 無料デプロイ環境の選択肢

### 1. Railway ⭐ **推奨**

**特徴:**
- MySQL完全互換（移行が最も簡単）
- $5の無料クレジット（一回限り）
- 使用量ベースの課金
- Git連携で自動デプロイ
- リアルタイムコラボレーション

**メリット:**
- 現在のMySQLスキーマをそのまま使用可能
- 設定が簡単で高速デプロイ
- 開発者体験が優秀

**デメリット:**
- 無料クレジット使い切り後は有料プラン必須（$5/月〜）
- バックグラウンドジョブは手動設定が必要

**料金:**
- 無料: $5クレジット（一回限り）
- 有料: $5/月〜（使用量ベース）

### 2. Render

**特徴:**
- PostgreSQL, Redis native support
- 無料プランあり（制限付き）
- バックグラウンドワーカー内蔵
- cron jobs対応

**メリット:**
- 完全無料プランあり
- 本格的なプロダクション機能
- 固定料金で予測しやすい

**デメリット:**
- MySQLは手動設定が必要
- データベース移行が必要（MySQL → PostgreSQL）

**料金:**
- 無料: 制限付きWebサービス
- 有料: $7/月〜

### 3. AWS Free Tier

**特徴:**
- EC2 t2.micro: 750時間/月（12ヶ月間）
- RDS db.t3.micro: 750時間/月（12ヶ月間）
- 20GB storage

**メリット:**
- 完全にコントロール可能
- スケーラビリティが高い
- 幅広いサービスが利用可能

**デメリット:**
- 設定が複雑
- 12ヶ月後は有料
- 運用管理が必要

### 4. Vercel + データベース

**特徴:**
- フロントエンド特化
- サーバーレス functions
- 優秀な開発者体験

**メリット:**
- フロントエンドのパフォーマンスが優秀
- CDN内蔵
- Git連携

**デメリット:**
- バックエンドはサーバーレス関数に制限
- MySQLサポートが限定的
- アーキテクチャ変更が必要

## データベース単体の選択肢

### 1. TiDB Serverless ⭐ **MySQL互換で推奨**

**特徴:**
- MySQL完全互換
- 25GB storage + 250M reads 無料
- 真のサーバーレス
- スケールゼロ対応

**料金:**
- 無料: 25GB storage + 250M reads
- 有料: $0.01/月〜

### 2. Neon

**特徴:**
- PostgreSQL互換
- 3GB storage 無料
- ブランチング機能

**料金:**
- 無料: 3GB storage
- 有料: $19/月〜

### 3. Supabase

**特徴:**
- PostgreSQL + Auth + Storage
- 500MB storage 無料
- リアルタイム機能

**料金:**
- 無料: 500MB storage
- 有料: $25/月〜

## 推奨デプロイ構成

### パターン1: 即戦力重視（移行コスト最小）

```yaml
フロントエンド: Vercel (無料)
バックエンド: Railway ($5クレジット → $5/月)
データベース: TiDB Serverless (無料 25GB)
```

**月額コスト:** 無料 → $5/月
**特徴:** 既存コードをほぼそのまま使用、設定が簡単
**適用場面:** 即座にデプロイしたい、DB移行を避けたい

### パターン2: 超小規模最適（10ユーザー程度）

```yaml
フロントエンド: Netlify (無料)
バックエンド: Render (無料プラン)
データベース: PostgreSQL移行 + Supabase (無料)
```

**月額コスト:** 完全無料（2ヶ月） → $6/月
**特徴:** 10ユーザー程度なら最も経済的
**適用場面:** 超小規模、初期コストを抑えたい

### パターン3: AWS活用

```yaml
フロントエンド: AWS S3 + CloudFront
バックエンド: AWS EC2 (Free Tier)
データベース: AWS RDS (Free Tier)
```

**月額コスト:** 12ヶ月無料 → 有料

## 移行手順（推奨: Railway + TiDB Serverless）

### 1. TiDB Serverlessでデータベース構築

```bash
# TiDB Cloudにサインアップ
# https://tidbcloud.com/

# 新しいServerlessクラスターを作成
# MySQLと完全互換なので、既存のスキーマがそのまま使用可能
```

### 2. Railwayでアプリケーションデプロイ

```bash
# Railwayにサインアップ
# https://railway.app/

# GitHubリポジトリを接続
# 環境変数を設定
DB_HOST=your_tidb_host
DB_USER=your_tidb_user
DB_PASSWORD=your_tidb_password
DB_NAME=splitmate
```

### 3. フロントエンドをVercelにデプロイ

```bash
# Vercelにサインアップ
# https://vercel.com/

# Next.js/Reactプロジェクトとして認識
# 自動でビルド・デプロイ
```

## コスト試算

### 想定利用量（月次）
- データベース: 1GB storage, 10M queries
- API: 100K requests
- フロントエンド: 10K page views

### パターン別コスト

#### **10ユーザー程度の場合**
| 項目 | Railway + TiDB | Render + Supabase | AWS Free Tier |
|------|----------------|-------------------|---------------|
| 初期費用 | $0 | $0 | $0 |
| 開発コスト | 低（移行不要） | 中（DB移行必要） | 高（インフラ設定） |
| 月額（1年目） | $9.6（1ヶ月無料後$10.5） | $5（2ヶ月無料後$6） | $0 |
| 月額（2年目以降） | $10.5 | $6 | $15-25 |
| 2年間総コスト | $241.5 | $132 | $180 |
| 制限 | 少ない | 中程度 | 設定次第 |

#### **一般的な利用の場合**
| 項目 | Railway + TiDB | Render + Supabase | AWS Free Tier |
|------|----------------|-------------------|---------------|
| 初期費用 | $0 | $0 | $0 |
| 開発コスト | 低（移行不要） | 中（DB移行必要） | 高（インフラ設定） |
| 月額（1年目） | $5 | $0 | $0 |
| 月額（2年目以降） | $10-15 | $25-30 | $20-30 |
| 2年間総コスト | $204 | $324 | $240 |
| 制限 | 少ない | 多い（スリープ等） | 設定次第 |

## パターン2でコストが発生するケース

### 📊 Render（バックエンド）の有料化条件

#### 🔴 **必ず発生するコスト**
1. **PostgreSQL Database（30日後）**
   - 無料PostgreSQLは30日で自動削除
   - 継続利用には有料プラン必須: **$6/月〜**

#### 🟡 **使用量超過によるコスト**
1. **帯域幅超過**
   - 無料: 100GB/月
   - 超過: **$55 per 100GB**

2. **ビルド分数超過**
   - 無料: 500分/月
   - 超過: **$7 per 500分**

3. **高性能インスタンス**
   - 無料インスタンス（512MB RAM）で不足の場合
   - Starter: **$7/月**（512MB RAM, 0.5 CPU）
   - Standard: **$25/月**（2GB RAM, 1 CPU）

### 📊 Supabase（データベース）の有料化条件

#### 🟡 **使用量超過によるコスト**
1. **データベースサイズ**
   - 無料: 500MB
   - 超過: **$0.125 per GB**
   - 例: 2GBなら月額$0.19

2. **ストレージサイズ**
   - 無料: 1GB
   - 超過: **$0.021 per GB**
   - 例: 5GBなら月額$0.08

3. **帯域幅（Egress）**
   - 無料: 5GB/月
   - 超過: **$0.09 per GB**
   - 例: 20GB/月なら$1.35

4. **月間アクティブユーザー（MAU）**
   - 無料: 50,000 MAU
   - 超過: **$0.00325 per MAU**

5. **Edge Function呼び出し**
   - 無料: 500,000/月
   - 超過: **$2 per million**

### 📊 Netlify（フロントエンド）の有料化条件

#### 🟡 **使用量超過によるコスト**
1. **帯域幅超過**
   - 無料: 100GB/月
   - 超過: **$55 per 100GB**

2. **ビルド分数超過**
   - 無料: 300分/月
   - 超過: **$7 per 500分**

3. **Function呼び出し**
   - 無料: 125,000/サイト/月
   - 超過: **$25+ when exceeded**

### 💰 現実的なコスト発生例

#### **超小規模アプリ（10ユーザー程度）**
```
想定使用量:
- DB: 10MB
- Storage: 100MB
- 帯域幅: 2GB/月
- ビルド: 100分/月

発生コスト:
- Render PostgreSQL: $6/月（30日後〜）
- その他: $0/月（全て無料枠内）

合計: $6/月（PostgreSQLのみ）
```

#### **小規模アプリ（月間1,000ユーザー）**
```
想定使用量:
- DB: 200MB
- Storage: 2GB
- 帯域幅: 30GB/月
- ビルド: 400分/月

発生コスト:
- Render PostgreSQL: $6/月（30日後〜）
- Supabase Storage: $0.02/月
- Supabase 帯域幅: $2.25/月
- Netlify ビルド: $7/月

合計: 約$15/月
```

#### **中規模アプリ（月間10,000ユーザー）**
```
想定使用量:
- DB: 2GB
- Storage: 10GB
- 帯域幅: 150GB/月
- ビルド: 1,000分/月

発生コスト:
- Render PostgreSQL: $19/月（Basic 1GB）
- Render 帯域幅: $55/月（100GB超過分）
- Supabase Database: $0.19/月
- Supabase Storage: $0.19/月
- Supabase 帯域幅: $13.05/月
- Netlify 帯域幅: $27.5/月
- Netlify ビルド: $14/月

合計: 約$129/月
```

### ⚠️ **特に注意すべきポイント**

1. **Render PostgreSQL（30日制限）**
   - これは**必ず発生**するコスト
   - 回避不可能

2. **帯域幅コスト**
   - 画像・動画が多いサイトは要注意
   - CDN無しで$55/100GBは高額

3. **ビルド分数**
   - 複雑なビルドプロセスで消費
   - 頻繁なデプロイで超過しやすい

4. **データベース容量**
   - ユーザー生成コンテンツで急拡大
   - 画像等をDBに保存すると即超過

### 🔄 **回避策**

1. **PostgreSQL代替案**
   - TiDB Serverless（MySQL互換・25GB無料）
   - Neon（PostgreSQL・3GB無料、ただし$19/月〜）

2. **帯域幅削減**
   - CloudflareなどのCDN利用
   - 画像最適化・圧縮

3. **ストレージ最適化**
   - 外部画像ホスティング利用
   - 定期的なデータクリーンアップ

### 📈 **コスト推移予測**

#### **10ユーザー程度の場合**
| 月 | 想定コスト | 主な要因 |
|----|------------|----------|
| 1-2月 | $0 | 完全無料期間 |
| 3月〜 | $6/月 | PostgreSQL必須化のみ |
| 6月〜 | $6/月 | 使用量は無料枠内 |
| 12月〜 | $6/月 | 継続して無料枠内 |

#### **一般的な利用の場合**
| 月 | 想定コスト | 主な要因 |
|----|------------|----------|
| 1-2月 | $0 | 完全無料期間 |
| 3月〜 | $6-15/月 | PostgreSQL必須化 |
| 6月〜 | $15-30/月 | 帯域幅・ストレージ超過 |
| 12月〜 | $25-50/月 | 全面的な使用量増加 |

**10ユーザー程度の超小規模利用の場合、パターン2でも長期的に$6/月で安定する可能性が高い**ことが分かります。

## パターン1の詳細試算（10ユーザー規模）

### 🧮 **Railway + TiDB Serverlessの詳細コスト分析**

#### **Railway（バックエンド・フロントエンド）**

**無料トライアル期間（30日間）:**
```
- $5クレジット（一回限り）
- 全てのリソースが$5枠内で収まる
- 実質コスト: $0
```

**Hobbyプラン移行後の月額コスト:**

**基本料金:**
- 月額サブスクリプション: $5
- 含まれるリソース使用量: $5

**10ユーザー規模での想定使用量:**
```
バックエンド（Node.js）:
- CPU: 0.1 vCPU（$2/月）
- メモリ: 0.5GB（$5/月）
- ストレージ: 1GB（$0.15/月）

フロントエンド（React）:
- CPU: 0.05 vCPU（$1/月）
- メモリ: 0.2GB（$2/月）
- ストレージ: 0.5GB（$0.075/月）

帯域幅（両方合計）:
- 月間転送量: 5GB（$0.25/月）

合計リソース使用量: 約$10.5/月
実際の請求額: $10.5/月（$5含まれるため$5.5追加）
```

#### **TiDB Serverless（データベース）**

**無料枠（組織全体）:**
```
- ストレージ: 25GB（5クラスター分）
- Request Units: 250M RUs/月（5クラスター分）
```

**10ユーザー規模での実際使用量:**
```
- データベースサイズ: 50MB
- 月間Request Units: 10M RUs
- 帯域幅: 2GB/月

全て無料枠内のため追加料金: $0/月
```

#### **Vercel（フロントエンドホスティング）**

**無料プラン:**
```
- 100GB帯域幅/月
- 100回ビルド/月
- カスタムドメイン: 1個

10ユーザー規模では全て無料枠内
追加料金: $0/月
```

### 💰 **月別コスト推移**

| 期間 | Railway | TiDB | Vercel | 合計 | 主な要因 |
|------|---------|------|--------|------|----------|
| **1ヶ月目** | $0 | $0 | $0 | **$0** | トライアル期間 |
| **2ヶ月目〜** | $10.5 | $0 | $0 | **$10.5/月** | Hobbyプラン安定 |
| **6ヶ月目〜** | $10.5 | $0 | $0 | **$10.5/月** | 使用量は無料枠内 |
| **12ヶ月目〜** | $10.5 | $0 | $0 | **$10.5/月** | 継続して安定 |

### 📊 **年間総コスト比較**

```
1年間の総コスト:
- 1ヶ月目: $0（無料トライアル）
- 11ヶ月間: $10.5 × 11 = $115.5
- 年間合計: $115.5

2年間の総コスト: $115.5 + $126 = $241.5
```

### ⚠️ **コスト増加の可能性**

#### **Railway側の制限超過リスク（低い）:**
```
CPU使用量が2倍になった場合:
- 追加コスト: +$3/月
- 新しい月額: $13.5

メモリ使用量が2倍になった場合:
- 追加コスト: +$7/月  
- 新しい月額: $17.5
```

#### **TiDB側の制限超過リスク（極めて低い）:**
```
データが5倍（250MB）に増えた場合も無料枠内
Request Unitsが5倍（50M RUs）になっても無料枠内
事実上の追加コストリスク: ほぼゼロ
```

### 🎯 **10ユーザー規模での結論**

**パターン1の優位性:**
1. **予測可能な固定コスト**: $10.5/月で安定
2. **無料枠の余裕**: TiDBは使用量の10倍の余裕
3. **MySQL完全互換**: 移行コストゼロ
4. **スケーラビリティ**: ユーザー数増加に対応可能

**リスク評価:**
- コスト変動リスク: **低**
- 技術的リスク: **極低**
- 移行作業: **不要**

## セキュリティ考慮事項

- **環境変数管理**: 各プラットフォームの環境変数機能を使用
- **HTTPS**: 全プラットフォームで標準対応
- **認証**: Google OAuth設定が必要
- **CORS**: フロントエンド・バックエンド間の設定

## 監視・運用

### Railway
- 内蔵メトリクス
- ログ表示機能
- アラート設定可能

### TiDB Serverless
- 使用量ダッシュボード
- クエリ分析機能
- 自動バックアップ

## まとめ

### **利用規模別の推奨**

#### **10ユーザー程度の超小規模**
**最もおすすめ**: Render + Supabase
- 2ヶ月完全無料、その後$6/月で安定
- PostgreSQL移行作業が必要だが1回限り
- Railway（$5/月〜）より経済的

**次点**: Railway + TiDB Serverless
- 移行が最も簡単（MySQL互換）
- 即座に$5/月の課金開始
- 長期的な安定性は高い

#### **中〜大規模利用**
**最もおすすめ**: Railway + TiDB Serverless
- 移行が最も簡単（MySQL互換）
- 現在のコードをほぼそのまま使用可能
- 長期的にコスト効率が良い
- 制限が少なく、安定運用可能

**学習・実験目的**: AWS Free Tier
- クラウドの基礎知識が身につく
- 設定が複雑で学習コストが高い
- 12ヶ月後は有料
- カスタマイズ性が高い

**コスト優先度の判断基準:**
- **10ユーザー程度** → パターン2（Render + Supabase）
- **即戦力重視** → パターン1（Railway + TiDB）
- **長期安定性** → パターン1（Railway + TiDB）

## 次のステップ

### **10ユーザー程度の場合（推奨: Render + Supabase）**
1. Supabaseアカウント作成
2. PostgreSQL移行計画策定
3. Renderアカウント作成
4. Netlifyアカウント作成
5. MySQL → PostgreSQL移行実行
6. デプロイテスト実行

### **即戦力重視の場合（推奨: Railway + TiDB）**
1. TiDB Serverlessアカウント作成
2. Railwayアカウント作成  
3. 環境変数の設定
4. デプロイテスト実行
5. 本番データの移行計画策定

## 参考リンク

- [Railway Documentation](https://docs.railway.app/)
- [TiDB Serverless Documentation](https://docs.pingcap.com/tidbcloud/)
- [Vercel Documentation](https://vercel.com/docs)
- [AWS Free Tier](https://aws.amazon.com/free/) 
